---
title: "Mixed_Modeling"
author: "Rachel"
date: "7/10/2020"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```

<style>
div.yellow pre { background-color:lightyellow; }
</style>

## 1. Load libraries
```{r message=FALSE, results='hide'}
x<-c("car", "lme4", "effects", "ggplot2", "grid", "gridExtra", "dplyr", "tibble", "stringr", "condformat", 'kableExtra', 'crayon', 'fitdistrplus', 'sjPlot', "tidyverse", "ggpubr", "cowplot")
lapply(x, require, character.only = TRUE)
```

## 2. Load data
```{r}
GC_Behavior=read.csv("GC_behavior_matched.csv", h=T) 
TL_NEO<-read.csv("Time-lagged_NEO.csv", h=T)
Concurrent_NEO<-read.csv("Concurrent_NEO.csv", h=T)
```

## 3. Linear Mixed Modeling
### fGC LMMs
```{r}
GC.LMM1=lmer(log(GC.final.conc)~ FreqAllProx + RelRank + (1|ID) + (1|Month), data=GC_Behavior)
GC.LMM2=lmer(log(GC.final.conc)~ FreqTotalGR + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
GC.LMM3=lmer(log(GC.final.conc)~ FreqGRRec + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
GC.LMM4=lmer(log(GC.final.conc)~ FreqGRGiven + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
GC.LMM5=lmer(log(GC.final.conc)~ FreqTimeSpentCop + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
GC.LMM6=lmer(log(GC.final.conc)~ FreqTimeSpentConsort + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
```


### fGC LMM summaries:
#### Fixed Effect variable: FreqAllProx
```{r echo=FALSE}
GC.LMM1=lmer(log(GC.final.conc)~ FreqAllProx + RelRank + (1|ID) + (1|Month), data=GC_Behavior)
summary(GC.LMM1)
AnovaGC.LMM1 <-Anova(GC.LMM1, type="III"); AnovaGC.LMM1
```

<div class = "yellow">
```{r echo=FALSE, class.source="yellow"}
cat("p=", AnovaGC.LMM1[2,3], ifelse(AnovaGC.LMM1[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTotalGR
```{r echo=FALSE}
GC.LMM2=lmer(log(GC.final.conc)~ FreqTotalGR + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
summary(GC.LMM2)
AnovaGC.LMM2 <- Anova(GC.LMM2, type="III"); AnovaGC.LMM2
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaGC.LMM2[2,3], ifelse(AnovaGC.LMM2[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqGRRec
```{r echo=FALSE}
GC.LMM3=lmer(log(GC.final.conc)~ FreqGRRec + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
summary(GC.LMM3)
AnovaGC.LMM3 <-Anova(GC.LMM3, type="III"); AnovaGC.LMM3
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaGC.LMM3[2,3], ifelse(AnovaGC.LMM3[2,3]<0.05, "**SIGNIFICANT**", "non-significant"))
```
</div>

#### Fixed Effect variable: FreqGRGiven
```{r}
GC.LMM4=lmer(log(GC.final.conc)~ FreqGRGiven + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
summary(GC.LMM4)
AnovaGC.LMM4 <- Anova(GC.LMM4, type="III"); AnovaGC.LMM4
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaGC.LMM4[2,3], ifelse(AnovaGC.LMM4[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTimeSpentCop
```{r}
GC.LMM5=lmer(log(GC.final.conc)~ FreqTimeSpentCop + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
summary(GC.LMM5)
AnovaGC.LMM5<- Anova(GC.LMM5, type="III"); AnovaGC.LMM5
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaGC.LMM5[2,3], ifelse(AnovaGC.LMM5[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTimeSpentConsort
```{r}
GC.LMM6=lmer(log(GC.final.conc)~ FreqTimeSpentConsort + RelRank + (1|ID) +(1|Month), data=GC_Behavior)
summary(GC.LMM6)
AnovaGC.LMM6<- Anova(GC.LMM6, type="III"); AnovaGC.LMM6
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaGC.LMM6[2,3], ifelse(AnovaGC.LMM6[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant")) 
```
</div>

#### Summary of Wald Chi-square p-values for Fixed Effects
```{r echo=FALSE}
GC.LMM.All.summary <-data.frame(Response_variable = "fGC", Fixed_Effect = c("FreqAllProx", "FreqTotalGr", "FreqGRRec", "FreqGRGiven", "FreqTimeSpentCop", "FreqTimeSpentConsort"), "Estimate" = c(summary(GC.LMM1)$coef[2,"Estimate"], summary(GC.LMM2)$coef[2,"Estimate"], summary(GC.LMM3)$coef[2,"Estimate"], summary(GC.LMM4)$coef[2,"Estimate"], summary(GC.LMM5)$coef[2,"Estimate"], summary(GC.LMM6)$coef[2,"Estimate"]), Std_Error= c(summary(GC.LMM1)$coef[2, "Std. Error"], summary(GC.LMM2)$coef[2, "Std. Error"], summary(GC.LMM3)$coef[2, "Std. Error"], summary(GC.LMM4)$coef[2, "Std. Error"], summary(GC.LMM5)$coef[2, "Std. Error"], summary(GC.LMM6)$coef[2, "Std. Error"]), t_value= c(summary(GC.LMM1)$coef[2, "t value"], summary(GC.LMM2)$coef[2, "t value"], summary(GC.LMM3)$coef[2, "t value"], summary(GC.LMM4)$coef[2, "t value"], summary(GC.LMM5)$coef[2, "t value"], summary(GC.LMM6)$coef[2, "t value"]), Walds_Chi_square= c(AnovaGC.LMM1[2,1], AnovaGC.LMM2[2,1], AnovaGC.LMM3[2,1], AnovaGC.LMM4[2,1], AnovaGC.LMM5[2,1], AnovaGC.LMM6[2,1]), P_value = c(AnovaGC.LMM1[2,3], AnovaGC.LMM2[2,3], AnovaGC.LMM3[2,3], AnovaGC.LMM4[2,3], AnovaGC.LMM5[2,3], AnovaGC.LMM6[2,3]))

GC.LMM.All.summary <- GC.LMM.All.summary %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate(P_value = cell_spec(P_value, "html", bold = ifelse(P_value > 0.05, FALSE, TRUE), color = ifelse(P_value > 0.05, "black", "red"))) %>%
  rename("P-value" = P_value, "Wald's Ï‡2" = Walds_Chi_square, "t-value" = t_value, "Std. Error"= Std_Error, "Fixed Effect"= Fixed_Effect, "Response Variable"= Response_variable) %>%
  kable(format="html", escape = F) %>%
  kable_styling(full_width=TRUE) %>%
  column_spec(7, background = "lightyellow"); GC.LMM.All.summary
```

#### fGC Proximity drop1 analysis
```{r}
library(lmerTest)
GC.LMM.Prox.drop1model=lmer(log(GC.final.conc)~ FreqJuvProx + FreqAMProx + FreqAFProx + RelRank +  (1|ID) + (1|Month), data=GC_Behavior)
```


```{r echo= FALSE}
GC.LMM.Prox.drop1test <- as.data.frame(drop1(GC.LMM.Prox.drop1model, test= "Chi"))

GC.LMM.Prox.drop1test.tidy <- GC.LMM.Prox.drop1test %>%
  rownames_to_column(var= "Fixed Effect") %>%
  rename("P_value" = "Pr(>F)") %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  column_spec(7, background = "lightyellow") %>%
  kable_styling(full_width=TRUE); GC.LMM.Prox.drop1test.tidy

detach("package:lmerTest", unload=TRUE)
```

### Time-lagged NEO LMMs
```{r}
NEO.TL.LMM1=lmer(log(NEO.CR)~ FreqAllProx  + RelRank + (1|ID) +(1|Month), data=TL_NEO)
NEO.TL.LMM2=lmer(log(NEO.CR)~ FreqTotalGR + RelRank +  (1|ID) +(1|Month), data=TL_NEO)
NEO.TL.LMM3=lmer(log(NEO.CR)~ FreqGRRec + RelRank + (1|ID) +(1|Month), data=TL_NEO)
NEO.TL.LMM4=lmer(log(NEO.CR)~ FreqGRGiven + RelRank + (1|ID) +(1|Month), data=TL_NEO)
NEO.TL.LMM5=lmer(log(NEO.CR)~ FreqTimeSpentCop + RelRank + (1|ID) + (1|Month), data=TL_NEO)
NEO.TL.LMM6=lmer(log(NEO.CR)~ FreqTimeSpentConsort + RelRank + (1|ID) +(1|Month), data=TL_NEO)
```

### Time-lagged NEO LMM summaries
#### Fixed Effect variable: FreqAllProx
```{r echo=FALSE}
NEO.TL.LMM1=lmer(log(NEO.CR)~ FreqAllProx + RelRank + (1|ID) + (1|Month), data=TL_NEO)
summary(NEO.TL.LMM1)
AnovaNEO.TL.LMM1 <-Anova(NEO.TL.LMM1, type="III"); AnovaNEO.TL.LMM1
```

<div class = "yellow">
```{r echo=FALSE, class.source="yellow"}
cat("p=", AnovaNEO.TL.LMM1[2,3], ifelse(AnovaNEO.TL.LMM1[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTotalGR
```{r echo=FALSE}
NEO.TL.LMM2=lmer(log(NEO.CR)~ FreqTotalGR + RelRank + (1|ID) +(1|Month), data=TL_NEO)
summary(NEO.TL.LMM2)
AnovaNEO.TL.LMM2 <- Anova(NEO.TL.LMM2, type="III"); AnovaNEO.TL.LMM2
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.TL.LMM2[2,3], ifelse(AnovaNEO.TL.LMM2[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqGRRec
```{r echo=FALSE}
NEO.TL.LMM3=lmer(log(NEO.CR)~ FreqGRRec + RelRank + (1|ID) +(1|Month), data=TL_NEO)
summary(NEO.TL.LMM3)
AnovaNEO.TL.LMM3 <-Anova(NEO.TL.LMM3, type="III"); AnovaNEO.TL.LMM3
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.TL.LMM3[2,3], ifelse(AnovaNEO.TL.LMM3[2,3]<0.05, "**SIGNIFICANT**", "non-significant"))
```
</div>

#### Fixed Effect variable: FreqGRGiven
```{r}
NEO.TL.LMM4=lmer(log(NEO.CR)~ FreqGRGiven + RelRank + (1|ID) +(1|Month), data=TL_NEO)
summary(NEO.TL.LMM4)
AnovaNEO.TL.LMM4 <- Anova(NEO.TL.LMM4, type="III"); AnovaNEO.TL.LMM4
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.TL.LMM4[2,3], ifelse(AnovaNEO.TL.LMM4[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTimeSpentCop
```{r}
NEO.TL.LMM5=lmer(log(NEO.CR)~ FreqTimeSpentCop + RelRank + (1|ID) +(1|Month), data=TL_NEO)
summary(NEO.TL.LMM5)
AnovaNEO.TL.LMM5<- Anova(NEO.TL.LMM5, type="III"); AnovaNEO.TL.LMM5
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.TL.LMM5[2,3], ifelse(AnovaNEO.TL.LMM5[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTimeSpentConsort
```{r}
NEO.TL.LMM6=lmer(log(NEO.CR)~ FreqTimeSpentConsort + RelRank + (1|ID) +(1|Month), data=TL_NEO)
summary(NEO.TL.LMM6)
AnovaNEO.TL.LMM6<- Anova(NEO.TL.LMM6, type="III"); AnovaNEO.TL.LMM6
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.TL.LMM6[2,3], ifelse(AnovaNEO.TL.LMM6[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant")) 
```
</div>

#### Summary of Wald Chi-square p-values for Fixed Effects
```{r echo=FALSE}
NEO.TL.LMM.All.summary <-data.frame(Response_variable = "Timelagged uNEO", Fixed_Effect = c("FreqAllProx", "FreqTotalGr", "FreqGRRec", "FreqGRGiven", "FreqTimeSpentCop", "FreqTimeSpentConsort"), "Estimate" = c(summary(NEO.TL.LMM1)$coef[2,"Estimate"], summary(NEO.TL.LMM2)$coef[2,"Estimate"], summary(NEO.TL.LMM3)$coef[2,"Estimate"], summary(NEO.TL.LMM4)$coef[2,"Estimate"], summary(NEO.TL.LMM5)$coef[2,"Estimate"], summary(NEO.TL.LMM6)$coef[2,"Estimate"]), P_value = c(AnovaNEO.TL.LMM1[2,3], AnovaNEO.TL.LMM2[2,3], AnovaNEO.TL.LMM3[2,3], AnovaNEO.TL.LMM4[2,3], AnovaNEO.TL.LMM5[2,3], AnovaNEO.TL.LMM6[2,3]))

NEO.TL.LMM.All.summary <- NEO.TL.LMM.All.summary %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  kable_styling(full_width=TRUE) %>%
  column_spec(4, background = "lightyellow"); NEO.TL.LMM.All.summary
```

#### Time-lagged NEO Total grooming drop1 analysis
```{r echo=FALSE}
library(lmerTest)
```

```{r}
NEO.TL.LMM.TotalGr.drop1model=lmer(log(NEO.CR)~ FreqTotalGrJuv + FreqTotalGrAM + FreqGRAF + RelRank +  (1|ID) + (1|Month), data=TL_NEO, REML=FALSE)
```


```{r echo=FALSE}
NEO.TL.LMM.TotalGr.drop1test <- as.data.frame(drop1(NEO.TL.LMM.TotalGr.drop1model, test= "Chi"))

NEO.TL.LMM.TotalGr.drop1test.tidy <- NEO.TL.LMM.TotalGr.drop1test %>%
  rownames_to_column(var= "Fixed Effect") %>%
  rename("P_value" = "Pr(>F)") %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  column_spec(7, background = "lightyellow") %>%
  kable_styling(full_width=TRUE); NEO.TL.LMM.TotalGr.drop1test.tidy
```

```{r echo=FALSE}
detach("package:lmerTest", unload=TRUE)
```

#### Time-lagged NEO Receiving grooming drop1 analysis
```{r echo=FALSE}
library(lmerTest)
```

```{r}
NEO.TL.LMM.RecGr.drop1model=lmer(log(NEO.CR)~ FreqGrRecJuv + FreqGrRecAM + FreqGrRecAF + RelRank + (1|ID) + (1|Month), data=TL_NEO, REML=FALSE)
```

```{r echo=FALSE}
NEO.TL.LMM.RecGr.drop1test <- as.data.frame(drop1(NEO.TL.LMM.RecGr.drop1model, test= "Chi"))

NEO.TL.LMM.RecGr.drop1test.tidy <- NEO.TL.LMM.RecGr.drop1test %>%
  rownames_to_column(var= "Fixed Effect") %>%
  rename("P_value" = "Pr(>F)") %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  column_spec(7, background = "lightyellow") %>%
  kable_styling(full_width=TRUE); NEO.TL.LMM.RecGr.drop1test.tidy
```

```{r echo=FALSE}
detach("package:lmerTest", unload=TRUE)
```

### Concurrent NEO LMMs:
```{r}
NEO.Con.LMM1=lmer(log(NEO.CR)~ FreqAllProx  + RelRank + (1|ID) + (1|Month), data=Concurrent_NEO)
NEO.Con.LMM2=lmer(log(NEO.CR)~ FreqTotalGR + RelRank +  (1|ID) +(1|Month), data=Concurrent_NEO)
NEO.Con.LMM3=lmer(log(NEO.CR)~ FreqGRRec + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
NEO.Con.LMM4=lmer(log(NEO.CR)~ FreqGRGiven + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
NEO.Con.LMM5=lmer(log(NEO.CR)~ FreqTimeSpentCop + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
NEO.Con.LMM6=lmer(log(NEO.CR)~ FreqTimeSpentConsort + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
```

### Concurrent NEO LMM summaries:
#### Fixed Effect variable: FreqAllProx
```{r echo=FALSE}
NEO.Con.LMM1=lmer(log(NEO.CR)~ FreqAllProx + RelRank + (1|ID) + (1|Month), data=Concurrent_NEO)
summary(NEO.Con.LMM1)
AnovaNEO.Con.LMM1 <-Anova(NEO.Con.LMM1, type="III"); AnovaNEO.Con.LMM1
```

<div class = "yellow">
```{r echo=FALSE, class.source="yellow"}
cat("p=", AnovaNEO.Con.LMM1[2,3], ifelse(AnovaNEO.Con.LMM1[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTotalGR
```{r echo=FALSE}
NEO.Con.LMM2=lmer(log(NEO.CR)~ FreqTotalGR + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
summary(NEO.Con.LMM2)
AnovaNEO.Con.LMM2 <- Anova(NEO.Con.LMM2, type="III"); AnovaNEO.Con.LMM2
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.Con.LMM2[2,3], ifelse(AnovaNEO.Con.LMM2[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqGRRec
```{r echo=FALSE}
NEO.Con.LMM3=lmer(log(NEO.CR)~ FreqGRRec + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
summary(NEO.Con.LMM3)
AnovaNEO.Con.LMM3 <-Anova(NEO.Con.LMM3, type="III"); AnovaNEO.Con.LMM3
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.Con.LMM3[2,3], ifelse(AnovaNEO.Con.LMM3[2,3]<0.05, "**SIGNIFICANT**", "non-significant"))
```
</div>

#### Fixed Effect variable: FreqGRGiven
```{r}
NEO.Con.LMM4=lmer(log(NEO.CR)~ FreqGRGiven + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
summary(NEO.Con.LMM4)
AnovaNEO.Con.LMM4 <- Anova(NEO.Con.LMM4, type="III"); AnovaNEO.Con.LMM4
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.Con.LMM4[2,3], ifelse(AnovaNEO.Con.LMM4[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTimeSpentCop
```{r}
NEO.Con.LMM5=lmer(log(NEO.CR)~ FreqTimeSpentCop + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
summary(NEO.Con.LMM5)
AnovaNEO.Con.LMM5<- Anova(NEO.Con.LMM5, type="III"); AnovaNEO.Con.LMM5
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.Con.LMM5[2,3], ifelse(AnovaNEO.Con.LMM5[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant"))
```
</div>

#### Fixed Effect variable: FreqTimeSpentConsort
```{r}
NEO.Con.LMM6=lmer(log(NEO.CR)~ FreqTimeSpentConsort + RelRank + (1|ID) +(1|Month), data=Concurrent_NEO)
summary(NEO.Con.LMM6)
AnovaNEO.Con.LMM6<- Anova(NEO.Con.LMM6, type="III"); AnovaNEO.Con.LMM6
```

<div class = "yellow">
```{r echo=FALSE}
cat("p=", AnovaNEO.Con.LMM6[2,3], ifelse(AnovaNEO.Con.LMM6[2,3]<0.05, red("**SIGNIFICANT**"), "non-significant")) 
```
</div>

#### Summary of Wald Chi-square p-values for Fixed Effects
```{r echo=FALSE}
NEO.Con.LMM.All.summary <-data.frame(Response_variable = "Concurrent uNEO", Fixed_Effect = c("FreqAllProx", "FreqTotalGr", "FreqGRRec", "FreqGRGiven", "FreqTimeSpentCop", "FreqTimeSpentConsort"), "Estimate" = c(summary(NEO.Con.LMM1)$coef[2,"Estimate"], summary(NEO.Con.LMM2)$coef[2,"Estimate"], summary(NEO.Con.LMM3)$coef[2,"Estimate"], summary(NEO.Con.LMM4)$coef[2,"Estimate"], summary(NEO.Con.LMM5)$coef[2,"Estimate"], summary(NEO.Con.LMM6)$coef[2,"Estimate"]), "P_value" = c(AnovaNEO.Con.LMM1[2,3], AnovaNEO.Con.LMM2[2,3], AnovaNEO.Con.LMM3[2,3], AnovaNEO.Con.LMM4[2,3], AnovaNEO.Con.LMM5[2,3], AnovaNEO.Con.LMM6[2,3]))

NEO.Con.LMM.All.summary <- NEO.Con.LMM.All.summary %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  kable_styling(full_width=TRUE) %>%
  column_spec(4, background = "lightyellow"); NEO.Con.LMM.All.summary
```

#### Concurrent NEO Total grooming drop1 analysis
```{r echo= FALSE}
library(lmerTest)
```

```{r}
NEO.Con.LMM.TotalGr.drop1model=lmer(log(NEO.CR)~ FreqTotalGrJuv + FreqTotalGrAM + FreqGRAF + RelRank +  (1|ID) + (1|Month), data=Concurrent_NEO, REML=FALSE)
```

```{r echo=FALSE}
NEO.Con.LMM.TotalGr.drop1test <- as.data.frame(drop1(NEO.Con.LMM.TotalGr.drop1model, test= "Chi")); NEO.Con.LMM.TotalGr.drop1test

NEO.Con.LMM.TotalGr.drop1test.tidy <- NEO.Con.LMM.TotalGr.drop1test %>%
  rownames_to_column(var= "Fixed Effect") %>%
  rename("P_value" = "Pr(>F)") %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  column_spec(7, background = "lightyellow") %>%
  kable_styling(full_width=TRUE); NEO.Con.LMM.TotalGr.drop1test.tidy
```


#### Concurrent NEO Receiving grooming drop1 analysis
```{r echo=FALSE}
library(lmerTest)
```


```{r}
NEO.Con.LMM.RecGr.drop1model=lmer(log(NEO.CR)~ FreqGrRecJuv + FreqGrRecAM + FreqGrRecAF + RelRank + (1|ID) + (1|Month), data=Concurrent_NEO, REML=FALSE)
```

```{r echo=FALSE}
NEO.Con.LMM.RecGr.drop1test <- as.data.frame(drop1(NEO.Con.LMM.RecGr.drop1model, test= "Chi"))

NEO.Con.LMM.RecGr.drop1test.tidy <- NEO.Con.LMM.RecGr.drop1test %>%
  rownames_to_column(var= "Fixed Effect") %>%
  rename("P_value" = "Pr(>F)") %>%
  mutate_if(is.numeric, round, 3) %>%
  mutate("P_value" = cell_spec(P_value, "html", color = ifelse(P_value > 0.05, "black", "red"))) %>%
  kable(format="html", escape = F) %>%
  column_spec(7, background = "lightyellow") %>%
  kable_styling(full_width=TRUE); NEO.Con.LMM.RecGr.drop1test.tidy
```


```{r echo=FALSE}
detach("package:lmerTest", unload=TRUE)
```

